---
title: Linux | Linux学习笔记Ⅰ：系统
date: 2019-4-9
categories: notes
tags:
 - Linux
photo: 
    - /blog/img/linux1.jpeg
---
<br>
<!-- more -->

## Linux 简介

Linux是一套免费使用和自由传播的类Unix操作系统，是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统。

Linux能运行主要的UNIX工具软件、应用程序和网络协议。它支持32位和64位硬件。Linux继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统。

各个场合都有使用各种Linux发行版，从嵌入式设备到超级计算机，并在服务器领域确定了地位，通常服务器使用LAMP(Linux+Apache+MySQL+PHP)或LNMP(Linux+Nginx+MySQL+PHP)组合。

## Linux启动与关闭

### 启动

1. 内核的引导

计算机打开电源，先BIOS开机自检，按照BIOS设置的启动设备来启动，操作系统接管硬件以后，首先读入/boot目录下的内核文件。

2. 运行init

init进程是系统所有进程的起点，init进程首先要读取配置文件/etc/inittab
```
###运行级别:

许多程序需要开机启动，它们在Windows叫'服务'，在Linux叫'守护进程'

init进程的一个任务就是去运行这些开机启动的程序
而不同的场合需要启动不同的程序，作服务器时要启动Apache，作桌面则不需要；Linux可以根据不同的场合分配不同的开机启动程序，称为'运行级别'。

###细分：

运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动
运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆
运行级别2：多用户状态(没有NFS)
运行级别3：完全的多用户状态(有NFS)，登陆后进入控制台命令行模式
运行级别4：系统未使用，保留
运行级别5：X11控制台，登陆后进入图形GUI模式
运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动
```
3. 系统初始化

在init的配置文件中有这么一行： si::sysinit:/etc/rc.d/rc.sysinit　它调用执行了/etc/rc.d/rc.sysinit，而rc.sysinit是一个bash shell的脚本，它主要是完成一些系统初始化的工作，rc.sysinit是每一个运行级别都要首先运行的重要脚本。

它主要完成的工作有：激活交换分区，检查磁盘，加载硬件模块以及其它一些需要优先执行任务。

4. 建立终端

rc执行完毕后，返回init。这时基本系统环境已经设置好了，各种守护进程也已经启动了。

init接下来会打开6个终端，以便用户登录系统。
在inittab中的以下6行就是定义了6个终端：
```
1:2345:respawn:/sbin/mingetty tty1 
2:2345:respawn:/sbin/mingetty tty2 
3:2345:respawn:/sbin/mingetty tty3 
4:2345:respawn:/sbin/mingetty tty4 
5:2345:respawn:/sbin/mingetty tty5 
6:2345:respawn:/sbin/mingetty tty6
```
5. 用户登录系统

+ 命令行登陆
+ ssh登陆
+ 图形界面登陆

之前的6个命令窗口终端都可以登陆，默认为tty1，可以用Ctrl+Alt+F1~F6来进入其中一个命令窗口界面

如果进入命令窗口界面后再返回图形界面，需按Ctrl+Alt+F7

### 关机

linux领域大多在服务器上，一般不会关机

关机的命令有：shutdown/reboot/halt/poweroff


**shutdown：** 可以给系统计划一个时间关机，可用于停止、关机、重启
```
# shutdown -p now  ### 关闭机器  
# shutdown -H now  ### 停止机器  
# shutdown -r09:35 ### 在 09:35am 重启机器
# shutdown -c      ### 取消关机
```
**halt：** 通知硬件来停止所有的cpu功能，但仍然保持通电，可以使系统处于低层维护状态；但有些情况它会完全关闭系统

```
# halt             ### 停止机器  
# halt -p          ### 关闭机器  
# halt --reboot    ### 重启机器
```
**poweroff：** 会发送一个 ACPI 信号来通知系统关机
```
# poweroff           ### 关闭机器  
# poweroff --halt    ### 停止机器  
# poweroff --reboot  ### 重启机器
```
**reboot：** 通知系统重启
```
# reboot           ### 重启机器  
# reboot --halt    ### 停止机器  
# reboot -p        ### 关闭机器
```
## Linux系统目录结构

###目录

*   **/bin**：
    `bin是Binary的缩写, 这个目录存放着最经常使用的命令。`

*   **/boot：**
    `这里存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件。`

*   **/dev ：**
    `dev是Device(设备)的缩写, 该目录下存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。`

*   **/etc：**
    `这个目录用来存放所有的系统管理所需要的配置文件和子目录。`

*   **/home**：
    `用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的。`

*   **/lib**：
    `这个目录里存放着系统最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。`

*   **/lost+found**：
    `这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。`

*   **/media**：
    `linux系统会自动识别一些设备，例如U盘、光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。`

*   **/mnt**：
    `系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。`

*   **/opt**：
     `这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。`

*   **/proc**：
    `这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。`
    `这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping你的机器：`

    `echo 1  >  /proc/sys/net/ipv4/icmp_echo_ignore_all`


*   **/root**：
    `该目录为系统管理员，也称作超级权限者的用户主目录。`

*   **/sbin**：
    `s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序。`

*   **/selinux**：
     `这个目录是Redhat/CentOS所特有的目录，Selinux是一个安全机制，类似于windows的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的。`

*   **/srv**：
     `该目录存放一些服务启动之后需要提取的数据。`

*   **/sys**：
    `这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。`

    `sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。`

    `该文件系统是内核设备树的一个直观反映。`

    `当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。`

*   **/tmp**：
    `这个目录是用来存放一些临时文件的。`

*   **/usr**：
     `这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于windows下的program files目录。`

*   **/usr/bin：**
    `系统用户使用的应用程序。`

*   **/usr/sbin：**
    `超级用户使用的比较高级的管理程序和系统守护程序。`

*   **/usr/src：**
    `内核源代码默认的放置目录。`

*   **/var**：
    `这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。`

*   **/run**：
    `是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除。如果你的系统上有 /var/run 目录，应该让它指向 run。`


---

### 补充

在此摘录一位网友的分类作以补充，分类很清楚：


**系统启动必须：**

*   **/boot：** 存放的启动Linux 时使用的内核文件，包括连接文件以及镜像文件。

*   **/etc：** 存放**所有**的系统需要的**配置文件**和**子目录列表，**更改目录下的文件可能会导致系统不能启动。

*   **/lib**：存放基本代码库（比如c++库），其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。

*   **/sys**： 这是linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统 sysfs 。sysfs文件系统集成了下面3种文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统。该文件系统是内核设备树的一个直观反映。当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中

**指令集合：**

*   **/bin：** 存放着最常用的程序和指令

*   **/sbin：** 只有系统管理员能使用的程序和指令。

**外部文件管理：**

*   **/dev ：** Device(设备)的缩写, 存放的是Linux的外部设备。
**注意：** 在Linux中访问设备和访问文件的方式是相同的。

*   **/media**：类windows的**其他设备，**例如U盘、光驱等等，识别后linux会把设备放到这个目录下。

*   **/mnt**：临时挂载别的文件系统的，我们可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容了。

**临时文件：**

*   **/run**：是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除。如果你的系统上有 /var/run 目录，应该让它指向 run。

*   **/lost+found**：一般情况下为空的，系统非法关机后，这里就存放一些文件。

*   **/tmp**：这个目录是用来存放一些临时文件的。

**账户：**

*   **/root**：系统管理员的用户主目录。

*   **/home**：用户的主目录，以用户的账号命名的。

*   **/usr**：用户的很多应用程序和文件都放在这个目录下，类似于windows下的program files目录。

*   **/usr/bin：** 系统用户使用的应用程序与指令。

*   **/usr/sbin：** 超级用户使用的比较高级的管理程序和系统守护程序。

*   **/usr/src：** 内核源代码默认的放置目录。

**运行过程中要用：**

*   **/var**：存放经常修改的数据，比如程序运行的日志文件（/var/log 目录下）。

*   **/proc**：管理**内存空间！**虚拟的目录，是系统内存的映射，我们可以直接访问这个目录来，获取系统信息。这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件来做修改。

**扩展用的：**

*   **/opt**：默认是空的，我们安装额外软件可以放在这个里面。

*   **/srv**：存放服务启动后需要提取的数据**（不用服务器就是空）**


&nbsp;
