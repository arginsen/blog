<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta name="google-site-verification" content="OcsZXBpQqAp8163-20wn3epncmCv_UBtqBLZmspy-NA">
  
  <title>ğŸ”¥ å‰ç«¯ | Vue2 åˆå§‹åŒ–æµç¨‹ - init | Arginsen&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="FrontendVue">
  
  
  
  
  <meta name="keywords" content="Frontend,Vue">
<meta property="og:type" content="article">
<meta property="og:title" content="ğŸ”¥ å‰ç«¯ | Vue2 åˆå§‹åŒ–æµç¨‹ - init">
<meta property="og:url" content="https://lixupeng.cn/blog/2021/07/26/2-frontend-vue-source2-init/index.html">
<meta property="og:site_name" content="Arginsen&#39;s Blog">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://lixupeng.cn/blog/img/vue.jpg">
<meta property="og:updated_time" content="2025-07-31T17:48:52.575Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ğŸ”¥ å‰ç«¯ | Vue2 åˆå§‹åŒ–æµç¨‹ - init">
<meta name="twitter:image" content="https://lixupeng.cn/blog/img/vue.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Arginsen&#39;s Blog" type="application/atom+xml">
  
  <link rel="icon" href="/blog/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/blog/css/style.css">

  <script src="/blog/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/blog/css/bootstrap.css">
  <link rel="stylesheet" href="/blog/css/fashion.css">
  <link rel="stylesheet" href="/blog/css/glyphs.css">

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  



<header id="allheader" class="site-header" role="banner" 
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/blog/" title="Arginsen&#39;s Blog" rel="home"> Arginsen&#39;s Blog </a>
            
          </h1>
          
          
            <div class="site-description">smells like teen spirit</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/blog/">é¦–é¡µ</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/blog/archives">å½’æ¡£</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/blog/categories">åˆ†ç±»</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/blog/about">å…³äº</a> </li>
                    
              </ul>
            </div>
          </nav>
      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-2-frontend-vue-source2-init" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/blog/img/vue.jpg" rel="gallery_cmdrpkoat0009jqpu3s9od7c5">
        <img src="/blog/img/vue.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      ğŸ”¥ å‰ç«¯ | Vue2 åˆå§‹åŒ–æµç¨‹ - init
    </h1>
  

      </header>
      <footer class="entry-meta entry-tips">
        
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/blog/categories/notes/">notes</a>

        
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Frontend/">Frontend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Vue/">Vue</a></li></ul>

        
	<span class="ico-date"></span>
	<a href="/blog/2021/07/26/2-frontend-vue-source2-init/" class="article-date">
	  <time datetime="2021-07-25T16:00:00.000Z" itemprop="datePublished">ä¸ƒæœˆ 26, 2021</time>
	</a>

        <!-- æ·»åŠ å­—æ•°ç»Ÿè®¡ -->
        
          <span class="ico-fontcount"></span><span class="post-count">7.1kå­—</span>
        
      </footer>
    

    <div class="article-entry" itemprop="articleBody">
      
        <p><br><br><a id="more"></a></p>
<p>æ¥ä¸Šç¯‡æ–‡ç«  vue2 æ‰“åŒ…æµç¨‹ï¼Œäº†è§£äº†æˆ‘ä»¬æ‹¿åˆ°æ‰‹çš„ Vue æ˜¯æ€æ ·çš„ä¸€ä¸ªç»“æ„ï¼Œä»æºç ä¸­å·²ç»æ‰§è¡Œäº†å“ªäº›æ­¥éª¤ã€‚<br>è¿™ç¯‡åˆ™æ¥ç€è®°å½•ï¼Œåˆå§‹åŒ–å¥½åçš„ Vue å‡½æ•°åœ¨è¢«æˆ‘ä»¬è°ƒç”¨åˆå§‹åŒ–æˆå®ä¾‹çš„è¿‡ç¨‹</p>
<h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>éœ€è¦ package.json ä¸­çš„ dev æŒ‡ä»¤ååŠ  sourcemap, æ–¹ä¾¿æˆ‘ä»¬ç›´æ¥çœ‹åˆ°æœªæ‰“åŒ…çš„æºä»£ç ï¼Œå¦åˆ™å°±ç›´æ¥åœ¨ dist/vue é‡Œç›´æ¥è·‘ï¼Œä¸åˆ©äºæˆ‘ä»¬ç†è§£ä»£ç ç»“æ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;dev&quot;: &quot;rollup -w -c scripts/config.js --environment TARGET:web-full-dev --sourcemap&quot;</span><br></pre></td></tr></table></figure>
<p>ç»§è€Œç›´æ¥å‘½ä»¤è¡Œæ ¹ç›®å½•ç›´æ¥æ‰§è¡Œ npm run devï¼Œæˆ–è€…ç›´æ¥åœ¨ package.json ä¸­ â€œscriptsâ€ ä¸Šè¾¹ debug ç¬¬ä¸€ä¸ªå‘½ä»¤</p>
<h2 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h2><p>é…ç½®åœ¨ vscode ä¸­è°ƒè¯•ï¼Œæ–°å»ºä¸€ä¸ªè°ƒè¯•ç¯å¢ƒ</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">  <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">  <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="attr">"configurations"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"chrome"</span>,</span><br><span class="line">      <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"Launch Chrome"</span>,</span><br><span class="line">      <span class="attr">"file"</span>: <span class="string">"$&#123;workspaceFolder&#125;/examples/my-practice/index.html"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç›´æ¥åœ¨æºç ä¸­æ‰“æ–­ç‚¹ï¼Œrun èµ·æ¥åœ¨ vscode ä¸­è·‘æ•´ä¸ªæµç¨‹</p>
<p>ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨æ‰“å¼€æˆ‘ä»¬çš„æµ‹è¯•ä¾‹å­ examples/my-practice é‡Œè¾¹çš„ index.html ï¼Œæ‰“å¼€æµè§ˆå™¨ console å°±å¯ä»¥æ‰“æ–­ç‚¹äº†ã€‚</p>
<h1 id="æ–­ç‚¹è°ƒè¯•æ•´ä¸ªæµç¨‹"><a href="#æ–­ç‚¹è°ƒè¯•æ•´ä¸ªæµç¨‹" class="headerlink" title="æ–­ç‚¹è°ƒè¯•æ•´ä¸ªæµç¨‹"></a>æ–­ç‚¹è°ƒè¯•æ•´ä¸ªæµç¨‹</h1><p>å¯ä»¥é…ç½®ä½ æƒ³è¦è°ƒè¯•çš„ vue åŠŸèƒ½ï¼Œæ¯”å¦‚ä½ æƒ³è¦äº†è§£å“åº”å¼ï¼Œé‚£ä¹ˆå°±åŠ å…¥ dataï¼Œç„¶åæŒ‰æ­¥éª¤çœ‹æºç é‡Œ vue æ€ä¹ˆå°†æ‹¿åˆ°çš„ data è½¬æ¢æˆå“åº”å¼ï¼Œåˆåœ¨æŒ‚è½½çš„è¿‡ç¨‹ä¸­åŠ å…¥è§‚å¯Ÿè€…ï¼Œå°†å…¶æ¸²æŸ“åˆ°é¡µé¢ï¼Œåç»­å¯¹æ•°æ®å†åšå‡ºæ”¹åŠ¨ï¼Œçœ‹åˆä¼šè§¦å‘å“ªäº›åŠŸèƒ½æ¥å®ç°æ•°æ®çš„æ›´æ–°</p>
<p>åˆæˆ–è€…ä½ æƒ³äº†è§£ vue çš„æŒ‡ä»¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥å†™ v-forã€v-model ç­‰æ¥è¿›è¡Œè°ƒè¯•</p>
<p>åˆæˆ–è€…æƒ³äº†è§£ vue çš„ç»„ä»¶ï¼Œè™šæ‹ŸèŠ‚ç‚¹ï¼Œé‚£å°±å¯ä»¥å†™å‡ ä¸ªå­ç»„ä»¶ï¼Œè¾¹è°ƒè¾¹çœ‹</p>
<p>ä¸‹è¾¹ç»™å‡ºä¸€ä¸ªä¾‹å­</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">"class"</span> @<span class="attr">click</span>=<span class="string">"update"</span>&gt;</span>$[sum]<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">balance</span>&gt;</span><span class="tag">&lt;/<span class="name">balance</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line">Vue.mixin(&#123;</span><br><span class="line">  created() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'parent created'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  delimiters: [<span class="string">'$['</span>, <span class="string">']'</span>],</span><br><span class="line">  components: &#123;</span><br><span class="line">    balance: &#123;</span><br><span class="line">      template: <span class="string">`</span></span><br><span class="line"><span class="string">          &lt;div&gt;</span></span><br><span class="line"><span class="string">            &lt;show @show-balance="show_balance"&gt;&lt;/show&gt;</span></span><br><span class="line"><span class="string">            &lt;div v-if="show"&gt;</span></span><br><span class="line"><span class="string">              &lt;ul&gt;</span></span><br><span class="line"><span class="string">                &lt;li v-for="food in foodList" :key="food.name"&gt;$[food.name]ï¼šï¿¥ $[food.price]&lt;/li&gt;</span></span><br><span class="line"><span class="string">              &lt;/ul&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div&gt;&lt;input v-model="text" /&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt; </span></span><br><span class="line"><span class="string">      `</span>,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        show_balance: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.show = !<span class="keyword">this</span>.show</span><br><span class="line">          <span class="built_in">console</span>.log(data)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          show: <span class="literal">false</span>,</span><br><span class="line">          foodList: [&#123;</span><br><span class="line">              name: <span class="string">'è‘±'</span>,</span><br><span class="line">              price: <span class="string">'10'</span>,</span><br><span class="line">              discount: <span class="number">.8</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              name: <span class="string">'å§œ'</span>,</span><br><span class="line">              price: <span class="string">'8'</span>,</span><br><span class="line">              discount: <span class="number">.6</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              name: <span class="string">'è’œ'</span>,</span><br><span class="line">              price: <span class="string">'8'</span>,</span><br><span class="line">              discount: <span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          logo: <span class="string">'æŸ¥è¯¢èœå•'</span>,</span><br><span class="line">          text: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    show: &#123;</span><br><span class="line">      template: <span class="string">`</span></span><br><span class="line"><span class="string">          &lt;button @click="on_click"&gt;$[logo]&lt;/button&gt;</span></span><br><span class="line"><span class="string">          &lt;div&gt;$[tips]&lt;/div&gt;</span></span><br><span class="line"><span class="string">      `</span>,</span><br><span class="line">      props: [<span class="string">'logo'</span>],</span><br><span class="line">      created() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'lifecycle created'</span>)</span><br><span class="line">        <span class="keyword">this</span>.tips = <span class="string">'ç‚¹å‡»ä¸Šæ–¹'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      mounted() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'mounted'</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          tips: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        on_click() &#123;</span><br><span class="line">          <span class="comment">// $emit è§¦å‘äº‹ä»¶ï¼Œä¼ é€’æ•°æ®</span></span><br><span class="line">          <span class="keyword">this</span>.$emit(<span class="string">'show-balance'</span>, &#123;</span><br><span class="line">            bad: <span class="number">1</span>,</span><br><span class="line">            ass: <span class="number">2</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    sum(val) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'the newVal of sum is'</span> + val)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      class: 'date',</span><br><span class="line">      base: <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    sum() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.base * <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    update() &#123;</span><br><span class="line">      <span class="keyword">this</span>.base += <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><p>æˆ‘ä»¬å°†è‡ªå·±å†™çš„é…ç½®ä¼ å…¥ Vue å‡½æ•°åï¼Œä¸‹ä¸€æ­¥å°±è¿›å…¥åˆ° Vue çš„å®ä¾‹åˆå§‹åŒ–é˜¶æ®µ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Vue</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp;</span><br><span class="line">    !(<span class="keyword">this</span> <span class="keyword">instanceof</span> Vue)</span><br><span class="line">  ) &#123;</span><br><span class="line">    warn(<span class="string">'Vue is a constructor and should be called with the `new` keyword'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>._init(options)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–é˜¶æ®µ, é¦–å…ˆä¼šåˆå¹¶ä¼ å…¥çš„é…ç½®, è¿™é‡Œä¼šè¿›è¡Œåˆ¤æ–­ï¼Œå½“å‰çš„å®ä¾‹æ˜¯ç»„ä»¶è¿˜æ˜¯æ ¹å®ä¾‹ï¼Œç»„ä»¶ä¼šåœ¨æ ¹å®ä¾‹å¤„ç† children æ—¶è¢«éå†ï¼Œåˆ¤æ–­æ˜¯ç»„ä»¶äº†åˆ™ä¼šæ‰“ä¸Š <code>_isComponent</code> æ ‡è®°ï¼Œç»„ä»¶åˆå§‹åŒ–æ—¶æœ‰ç»„ä»¶çš„åˆå¹¶æœºåˆ¶ï¼Œæ ¹å®ä¾‹åˆ™æœ‰æ ¹å®ä¾‹çš„åˆå¹¶æœºåˆ¶ã€‚</p>
<p>é…ç½® proxy ä»£ç†ç¯å¢ƒï¼Œå¦‚æœä¸ºå¼€å‘ç¯å¢ƒåˆ™åˆå§‹åŒ–ä¸€ä¸ªä»£ç†ï¼Œå¦åˆ™æŒ‡å‘vueå®ä¾‹æœ¬èº«</p>
<p>æ¥ç€ä¿å­˜å½“å‰çš„å®ä¾‹ä¸º _self</p>
<p>ä¹‹åå°±è¿›å…¥ä¸€è¿ä¸²çš„åˆå§‹åŒ–ï¼Œåœ¨ beforeCreate ä¹‹å‰ï¼Œæ‰§è¡Œäº† initLifecycleã€initEventsã€initRender ä¸‰è€…çš„åˆå§‹åŒ–ï¼Œå…·ä½“å¯æŸ¥çœ‹ä¸‹ä¸€çº§æ ‡é¢˜ï¼›æ­¤å‰å¹¶æ²¡æœ‰åˆå§‹åŒ–åˆ°æ•°æ®å†…å®¹ stateï¼Œé‚£ä¹ˆ beforeCreate çš„é’©å­å‡½æ•°ä¸­å°±ä¸èƒ½è·å–åˆ° propsã€data ä¸­å®šä¹‰çš„å€¼ï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ methods ä¸­å®šä¹‰çš„å‡½æ•°ã€‚</p>
<p>åœ¨ beforeCreate å’Œ created ä¹‹é—´ï¼Œåˆå§‹åŒ–äº† initInjectionsã€initStateã€initProvide ï¼Œå…¶ä¸­ provide/inject éœ€è¦ä¸€èµ·ä½¿ç”¨ï¼Œç”±ç¥–å…ˆç»„ä»¶æä¾›äº†ä¸€ä¸ª provideï¼Œprovide é‡Œçš„å±æ€§å¯ä¾›æ‰€æœ‰çš„åä»£ç»„ä»¶é€šè¿‡ inject æ³¨å…¥å¹¶è°ƒç”¨ï¼Œå…·ä½“å¯æŸ¥çœ‹ä¸‹ä¸€çº§æ ‡é¢˜ï¼›</p>
<p>é‚£ä¹ˆæ­¤æ—¶ created é’©å­å‡½æ•°å°±å¯ä»¥è¯»å–åˆ° dataã€propsã€methodsã€computed ç­‰å±æ€§ï¼›æ­¤å¤–åœ¨è¿™ä¿©ä¸ªé’©å­å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æ¸²æŸ“ DOMï¼Œæ‰€ä»¥ä¸èƒ½å¤Ÿè®¿é—® DOMï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœç»„ä»¶åœ¨åŠ è½½çš„æ—¶å€™éœ€è¦å’Œåç«¯æœ‰äº¤äº’ï¼Œæ”¾åœ¨è¿™ä¿©ä¸ªé’©å­å‡½æ•°æ‰§è¡Œéƒ½å¯ä»¥</p>
<p>æœ€ååˆ¤æ–­ <code>vm.$options</code> é…ç½®ä¸Šæ˜¯å¦å­˜åœ¨ el å±æ€§ï¼Œå¦‚æœ‰ï¼Œåˆ™æ‰§è¡ŒæŒ‚è½½æ“ä½œã€‚æ­¤ el ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¾‹å­ä¸­å®ä¾‹æ‰€é…ç½®çš„å…ƒç´ æ ‡ç­¾ï¼Œè€Œåœ¨ç»„ä»¶ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œå› ä¸ºæœ€åç»„ä»¶éƒ½ä¼šæ•´åˆåˆ°å®ä¾‹ä¸Šï¼Œä¸€èµ·æŒ‚è½½åˆ° <code>#app</code> ä¸Š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/init.js</span></span><br><span class="line"></span><br><span class="line">Vue.prototype._init = <span class="function"><span class="keyword">function</span> (<span class="params">options?: Object</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> vm: Component = <span class="keyword">this</span></span><br><span class="line">    <span class="comment">// a uid</span></span><br><span class="line">    vm._uid = uid++</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> startTag, endTag</span><br><span class="line">    <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; config.performance &amp;&amp; mark) &#123;</span><br><span class="line">      startTag = <span class="string">`vue-perf-start:<span class="subst">$&#123;vm._uid&#125;</span>`</span></span><br><span class="line">      endTag = <span class="string">`vue-perf-end:<span class="subst">$&#123;vm._uid&#125;</span>`</span></span><br><span class="line">      mark(startTag)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// a flag to avoid this being observed</span></span><br><span class="line">    vm._isVue = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// merge options</span></span><br><span class="line">    <span class="keyword">if</span> (options &amp;&amp; options._isComponent) &#123;</span><br><span class="line">      <span class="comment">// optimize internal component instantiation</span></span><br><span class="line">      <span class="comment">// since dynamic options merging is pretty slow, and none of the</span></span><br><span class="line">      <span class="comment">// internal component options needs special treatment.</span></span><br><span class="line">      initInternalComponent(vm, options)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      vm.$options = mergeOptions(</span><br><span class="line">        resolveConstructorOptions(vm.constructor), <span class="comment">// vue çš„æ„é€ å™¨</span></span><br><span class="line">        options || &#123;&#125;,</span><br><span class="line">        vm</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">      initProxy(vm)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      vm._renderProxy = vm</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// expose real self</span></span><br><span class="line">    vm._self = vm</span><br><span class="line">    initLifecycle(vm)</span><br><span class="line">    initEvents(vm)</span><br><span class="line">    initRender(vm)</span><br><span class="line">    callHook(vm, <span class="string">'beforeCreate'</span>)</span><br><span class="line">    initInjections(vm) <span class="comment">// resolve injections before data/props</span></span><br><span class="line">    initState(vm) <span class="comment">// æˆªè‡³ created å‡½æ•°å‰ï¼Œvue å®ä¾‹ä¸Šçš„æ•°æ®éƒ½å‡†å¤‡å¥½äº†</span></span><br><span class="line">    initProvide(vm) <span class="comment">// resolve provide after data/props</span></span><br><span class="line">    callHook(vm, <span class="string">'created'</span>) <span class="comment">// æ­¤æ—¶æ‰§è¡Œ created é’©å­å‡½æ•°ï¼Œæ•°æ®å·²å‡†å¤‡å¥½</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; config.performance &amp;&amp; mark) &#123;</span><br><span class="line">      vm._name = formatComponentName(vm, <span class="literal">false</span>)</span><br><span class="line">      mark(endTag)</span><br><span class="line">      measure(<span class="string">`vue <span class="subst">$&#123;vm._name&#125;</span> init`</span>, startTag, endTag)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vm.$options.el) &#123;</span><br><span class="line">      vm.$mount(vm.$options.el) <span class="comment">// è‹¥å½“å‰ç»„ä»¶å‚æ•°ä¸­æœ‰èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡ŒæŒ‚è½½æ“ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="mergeOptions"><a href="#mergeOptions" class="headerlink" title="mergeOptions"></a>mergeOptions</h3><p>æ­¤æ—¶èµ°çš„æµç¨‹æ˜¯æ ¹å®ä¾‹åˆå¹¶é…ç½®ï¼Œç”¨ mergeOptions å°†å®ä¾‹ vm çš„æ„é€ å‡½æ•°çš„ options å’Œç”¨æˆ·ä¼ å…¥çš„ options è¿›è¡Œåˆå¹¶ï¼Œé¦–å…ˆä¼šæ£€æŸ¥ç”¨æˆ·ä¼ å…¥çš„é…ç½®ä¸­æ˜¯å¦ç»„ä»¶ componentsï¼Œæœ‰åˆ™ç»§ç»­ç¡®è®¤ç»„ä»¶çš„å‘½åæ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œé‚£ä¹ˆæˆ‘è¿™é‡Œçš„ä¸¤ä¸ªç»„ä»¶ balance å’Œ show éƒ½æ˜¯æ²¡æœ‰é—®é¢˜æ»´, å‡æ”¾å…¥ <code>$options.components</code></p>
<p>æ¥ç€æ ‡å‡†åŒ–æ ¹å®ä¾‹ä¼ å…¥çš„ propsã€injectï¼Œdirectivesï¼›å†å°†ä¸¤è€…é…ç½®ä¸­çš„ extendsã€mixins é€’å½’åˆå¹¶è‡³ parent ï¼Œæœ€åå°† parent å’Œ child å„å±æ€§å†åˆå¹¶åœ¨ä¸€èµ·ï¼Œè¿”å› options ç»™ <code>vm.$options</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/util/options.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeOptions</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  parent: Object, <span class="regexp">//</span> Vue æ„é€ å‡½æ•°çš„ option</span></span></span><br><span class="line"><span class="function"><span class="params">  child: Object, <span class="regexp">//</span> ç”¨æˆ·ä¼ å…¥çš„ option</span></span></span><br><span class="line"><span class="function"><span class="params">  vm?: Component <span class="regexp">//</span> vue å®ä¾‹</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">Object</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">    checkComponents(child)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> child === <span class="string">'function'</span>) &#123;</span><br><span class="line">    child = child.options</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  normalizeProps(child, vm)</span><br><span class="line">  normalizeInject(child, vm)</span><br><span class="line">  normalizeDirectives(child)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Apply extends and mixins on the child options,</span></span><br><span class="line">  <span class="comment">// but only if it is a raw options object that isn't</span></span><br><span class="line">  <span class="comment">// the result of another mergeOptions call.</span></span><br><span class="line">  <span class="comment">// Only merged options has the _base property.</span></span><br><span class="line">  <span class="keyword">if</span> (!child._base) &#123;</span><br><span class="line">    <span class="keyword">if</span> (child.extends) &#123;</span><br><span class="line">      parent = mergeOptions(parent, child.extends, vm) <span class="comment">// é€’å½’å°† extends åˆå¹¶åˆ° parent</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (child.mixins) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l = child.mixins.length; i &lt; l; i++) &#123;</span><br><span class="line">        parent = mergeOptions(parent, child.mixins[i], vm) <span class="comment">// é€’å½’å°† mixins åˆå¹¶åˆ° parent</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°† parent å’Œ child åˆå¹¶</span></span><br><span class="line">  <span class="keyword">const</span> options = &#123;&#125;</span><br><span class="line">  <span class="keyword">let</span> key</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> parent) &#123;</span><br><span class="line">    mergeField(key)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> child) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!hasOwn(parent, key)) &#123;</span><br><span class="line">      mergeField(key)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">mergeField</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> strat = strats[key] || defaultStrat</span><br><span class="line">    options[key] = strat(parent[key], child[key], vm, key)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> options</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="initProxy"><a href="#initProxy" class="headerlink" title="initProxy"></a>initProxy</h3><p>é…ç½® proxy ä»£ç†ç¯å¢ƒï¼Œå¦‚æœä¸ºå¼€å‘ç¯å¢ƒåˆ™åˆå§‹åŒ–ä¸€ä¸ªä»£ç†ï¼Œå¦åˆ™æŒ‡å‘vueå®ä¾‹æœ¬èº«ï¼›å¼€å‘ç¯å¢ƒä¸‹è‹¥å½“å‰ç¯å¢ƒ proxy å¯ç”¨ï¼Œåˆ™æ ¹æ® options ä¸­æ˜¯å¦é…ç½® render ç›¸å…³ï¼Œæ¥åŒ¹é…ç»™ vm ä»£ç†å¢åŠ ä»€ä¹ˆæ–¹æ³•ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨ vm ä¸Šçš„æ–¹æ³•å±æ€§æ—¶ï¼Œä¼šä¾æ®æ­¤æ–¹æ³•è¿›è¡Œæ£€æµ‹ï¼Œä¸ç¬¦åˆåˆ™ä¼šæŠ¥é”™ï¼›è‹¥æ˜¯å½“å‰ç¯å¢ƒä¸æ”¯æŒ proxy ï¼Œåˆ™ç›´æ¥ä»¤ <code>_renderProxy</code> æŒ‡å‘å½“å‰çš„å®ä¾‹ vm</p>
<p>å…¶ä¸­ getHandler æ–¹æ³•ï¼Œä¸»è¦æ˜¯é’ˆå¯¹è¯»å–ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶è¿›è¡Œçš„æ“ä½œã€‚å½“è®¿é—®çš„å±æ€§ä¸æ˜¯ string ç±»å‹æˆ–è€…å±æ€§å€¼åœ¨è¢«ä»£ç†çš„å¯¹è±¡ä¸Šä¸å­˜åœ¨ï¼Œåˆ™æŠ›å‡ºé”™è¯¯æç¤ºã€‚</p>
<p>hasHandleræ–¹æ³•å¯ä»¥æŸ¥çœ‹ vm å®ä¾‹æ˜¯å¦æ‹¥æœ‰æŸä¸ªå±æ€§ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ â€” æ¯”å¦‚è°ƒç”¨ for in å¾ªç¯éå† vm å®ä¾‹å±æ€§æ—¶ï¼Œä¼šè§¦å‘ hasHandler æ–¹æ³•ï¼Œé¦–å…ˆä½¿ç”¨ in æ“ä½œç¬¦åˆ¤æ–­è¯¥å±æ€§æ˜¯å¦åœ¨ vm å®ä¾‹ä¸Šå­˜åœ¨ï¼Œå†é€šè¿‡ allowedGlobals ç¡®å®šå±æ€§åç§°æ˜¯å¦å¯ç”¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/proxy.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hasProxy =</span><br><span class="line">  <span class="keyword">typeof</span> <span class="built_in">Proxy</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Proxy</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (hasProxy) &#123;</span><br><span class="line">  <span class="keyword">const</span> isBuiltInModifier = makeMap(<span class="string">'stop,prevent,self,ctrl,shift,alt,meta,exact'</span>)</span><br><span class="line">  config.keyCodes = <span class="keyword">new</span> <span class="built_in">Proxy</span>(config.keyCodes, &#123;</span><br><span class="line">    <span class="keyword">set</span> (target, key, value) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isBuiltInModifier(key)) &#123;</span><br><span class="line">        warn(<span class="string">`Avoid overwriting built-in modifier in config.keyCodes: .<span class="subst">$&#123;key&#125;</span>`</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        target[key] = value</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hasHandler = &#123;</span><br><span class="line">  has (target, key) &#123;</span><br><span class="line">    <span class="keyword">const</span> has = key <span class="keyword">in</span> target</span><br><span class="line">    <span class="keyword">const</span> isAllowed = allowedGlobals(key) ||</span><br><span class="line">      (<span class="keyword">typeof</span> key === <span class="string">'string'</span> &amp;&amp; key.charAt(<span class="number">0</span>) === <span class="string">'_'</span> &amp;&amp; !(key <span class="keyword">in</span> target.$data))</span><br><span class="line">    <span class="keyword">if</span> (!has &amp;&amp; !isAllowed) &#123;</span><br><span class="line">      <span class="keyword">if</span> (key <span class="keyword">in</span> target.$data) warnReservedPrefix(target, key)</span><br><span class="line">      <span class="keyword">else</span> warnNonPresent(target, key)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> has || !isAllowed</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getHandler = &#123;</span><br><span class="line">  <span class="keyword">get</span> (target, key) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> key === <span class="string">'string'</span> &amp;&amp; !(key <span class="keyword">in</span> target)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (key <span class="keyword">in</span> target.$data) warnReservedPrefix(target, key)</span><br><span class="line">      <span class="keyword">else</span> warnNonPresent(target, key)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target[key]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">initProxy = <span class="function"><span class="keyword">function</span> <span class="title">initProxy</span> (<span class="params">vm</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (hasProxy) &#123;</span><br><span class="line">    <span class="comment">// determine which proxy handler to use</span></span><br><span class="line">    <span class="keyword">const</span> options = vm.$options</span><br><span class="line">    <span class="keyword">const</span> handlers = options.render &amp;&amp; options.render._withStripped</span><br><span class="line">      ? getHandler <span class="comment">// è¯»å–ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§</span></span><br><span class="line">      : hasHandler <span class="comment">// æŸ¥è¯¢ä»£ç†å¯¹è±¡çš„æŸä¸ªå±æ€§</span></span><br><span class="line">    vm._renderProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(vm, handlers)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    vm._renderProxy = vm</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="initLifecycle"><a href="#initLifecycle" class="headerlink" title="initLifecycle"></a>initLifecycle</h3><p>åˆå§‹åŒ– <code>$parent, $root, $children, $refs</code>, å½“å‰æ ¹å®ä¾‹æ²¡æœ‰ <code>$parent</code>, æ‰€ä»¥å°±è®°ä¸ºå®ä¾‹æœ¬èº«ï¼Œæ¥ç€å†åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸç³»åˆ—å†…éƒ¨å±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/lifecycle.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initLifecycle</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> options = vm.$options</span><br><span class="line"></span><br><span class="line">  <span class="comment">// locate first non-abstract parent</span></span><br><span class="line">  <span class="keyword">let</span> parent = options.parent</span><br><span class="line">  <span class="keyword">if</span> (parent &amp;&amp; !options.abstract) &#123; <span class="comment">// å¦‚æœå­˜åœ¨çˆ¶çº§</span></span><br><span class="line">    <span class="keyword">while</span> (parent.$options.abstract &amp;&amp; parent.$parent) &#123;</span><br><span class="line">      parent = parent.$parent <span class="comment">// å®šä½è‡³ç¬¬ä¸€ä¸ªä¸æŠ½è±¡çš„çˆ¶çº§</span></span><br><span class="line">    &#125;</span><br><span class="line">    parent.$children.push(vm) <span class="comment">// å°†å½“å‰ç»„ä»¶ä½œä¸ºè¯¥çˆ¶çº§çš„å­çº§</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  vm.$parent = parent</span><br><span class="line">  vm.$root = parent ? parent.$root : vm <span class="comment">// å¦‚æ— çˆ¶çº§ï¼Œåˆ™ç»„ä»¶çš„æ ¹çº§å°±æ˜¯è‡ªå·±</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–ç»„ä»¶çš„å­çº§ç»„ã€ref</span></span><br><span class="line">  vm.$children = []</span><br><span class="line">  vm.$refs = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸç³»åˆ—å†…éƒ¨å±æ€§</span></span><br><span class="line">  vm._watcher = <span class="literal">null</span></span><br><span class="line">  vm._inactive = <span class="literal">null</span></span><br><span class="line">  vm._directInactive = <span class="literal">false</span></span><br><span class="line">  vm._isMounted = <span class="literal">false</span></span><br><span class="line">  vm._isDestroyed = <span class="literal">false</span></span><br><span class="line">  vm._isBeingDestroyed = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="initEvents"><a href="#initEvents" class="headerlink" title="initEvents"></a>initEvents</h3><p>æ ¹å®ä¾‹æ²¡æœ‰ä»€ä¹ˆå˜åŠ¨ï¼Œåªæ˜¯åˆå§‹åŒ–äº† <code>_eventsã€_hasHookEvent</code> ä¸¤ä¸ªå±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/events.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initEvents</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  vm._events = <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">  vm._hasHookEvent = <span class="literal">false</span></span><br><span class="line">  <span class="comment">// init parent attached events</span></span><br><span class="line">  <span class="keyword">const</span> listeners = vm.$options._parentListeners</span><br><span class="line">  <span class="keyword">if</span> (listeners) &#123;</span><br><span class="line">    updateComponentListeners(vm, listeners)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="initRender"><a href="#initRender" class="headerlink" title="initRender"></a>initRender</h3><p>initRender åˆå§‹åŒ–åšäº†ä¸€äº›è™šæ‹ŸèŠ‚ç‚¹ç›¸å…³çš„å·¥ä½œï¼Œåˆå§‹åŒ–äº† _vnodeã€ $vnode, $vnode è¿™é‡Œä¹ŸæŒ‡å‘ parentVnode , ä»£è¡¨å½“å‰å®ä¾‹è™šæ‹ŸèŠ‚ç‚¹çš„çˆ¶çº§èŠ‚ç‚¹ï¼Œç”±äºå½“å‰å®ä¾‹ä¸ºæ ¹å®ä¾‹ï¼Œé‚£ä¹ˆè‡ªç„¶æ—¶ä¸å­˜åœ¨çš„ï¼›_vnode åˆ™è¡¨ç¤ºå½“å‰å®ä¾‹çš„æ ¹è™šæ‹ŸèŠ‚ç‚¹</p>
<p>æ¥ç€ <code>vm._c</code>ã€<code>vm.$createElement</code> æ˜¯å¾ˆé‡è¦çš„æ–¹æ³•ï¼ŒcreateElement æ–¹æ³•ç”¨æ¥åˆ›å»º VNode</p>
<p>æœ€åç»™å½“å‰æ ¹å®ä¾‹æ·»åŠ  <code>$attrsã€$listeners</code> ä¸¤ä¸ªå“åº”å¼å±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/render.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initRender</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  vm._vnode = <span class="literal">null</span> <span class="comment">// the root of the child tree</span></span><br><span class="line">  vm._staticTrees = <span class="literal">null</span> <span class="comment">// v-once cached trees</span></span><br><span class="line">  <span class="keyword">const</span> options = vm.$options</span><br><span class="line">  <span class="keyword">const</span> parentVnode = vm.$vnode = options._parentVnode <span class="comment">// the placeholder node in parent tree</span></span><br><span class="line">  <span class="keyword">const</span> renderContext = parentVnode &amp;&amp; parentVnode.context</span><br><span class="line">  vm.$slots = resolveSlots(options._renderChildren, renderContext)</span><br><span class="line">  vm.$scopedSlots = emptyObject</span><br><span class="line">  <span class="comment">// bind the createElement fn to this instance</span></span><br><span class="line">  <span class="comment">// so that we get proper render context inside it.</span></span><br><span class="line">  <span class="comment">// args order: tag, data, children, normalizationType, alwaysNormalize</span></span><br><span class="line">  <span class="comment">// internal version is used by render functions compiled from templates</span></span><br><span class="line">  vm._c = <span class="function">(<span class="params">a, b, c, d</span>) =&gt;</span> createElement(vm, a, b, c, d, <span class="literal">false</span>)</span><br><span class="line">  <span class="comment">// normalization is always applied for the public version, used in</span></span><br><span class="line">  <span class="comment">// user-written render functions.</span></span><br><span class="line">  vm.$createElement = <span class="function">(<span class="params">a, b, c, d</span>) =&gt;</span> createElement(vm, a, b, c, d, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// $attrs &amp; $listeners are exposed for easier HOC creation.</span></span><br><span class="line">  <span class="comment">// they need to be reactive so that HOCs using them are always updated</span></span><br><span class="line">  <span class="keyword">const</span> parentData = parentVnode &amp;&amp; parentVnode.data</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">    defineReactive(vm, <span class="string">'$attrs'</span>, parentData &amp;&amp; parentData.attrs || emptyObject, () =&gt; &#123;</span><br><span class="line">      !isUpdatingChildComponent &amp;&amp; warn(<span class="string">`$attrs is readonly.`</span>, vm)</span><br><span class="line">    &#125;, <span class="literal">true</span>)</span><br><span class="line">    defineReactive(vm, <span class="string">'$listeners'</span>, options._parentListeners || emptyObject, () =&gt; &#123;</span><br><span class="line">      !isUpdatingChildComponent &amp;&amp; warn(<span class="string">`$listeners is readonly.`</span>, vm)</span><br><span class="line">    &#125;, <span class="literal">true</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    defineReactive(vm, <span class="string">'$attrs'</span>, parentData &amp;&amp; parentData.attrs || emptyObject, <span class="literal">null</span>, <span class="literal">true</span>)</span><br><span class="line">    defineReactive(vm, <span class="string">'$listeners'</span>, options._parentListeners || emptyObject, <span class="literal">null</span>, <span class="literal">true</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="beforeCreate"><a href="#beforeCreate" class="headerlink" title="__beforeCreate__"></a><code>__beforeCreate__</code></h3><h3 id="initInjections"><a href="#initInjections" class="headerlink" title="initInjections"></a>initInjections</h3><p>åœ¨åˆå§‹åŒ– data/props ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¯¹ inject å±æ€§ä¸­çš„å„ä¸ªkeyè¿›è¡Œéå†ï¼Œç„¶åæ²¿ç€çˆ¶ç»„ä»¶é“¾ä¸€ç›´å‘ä¸ŠæŸ¥æ‰¾ provide ä¸­å’Œ inject å¯¹åº”çš„å±æ€§ï¼Œç›´åˆ°æŸ¥æ‰¾åˆ°æ ¹ç»„ä»¶æˆ–è€…æ‰¾åˆ°ä¸ºæ­¢ï¼Œç„¶åè¿”å›ç»“æœã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/inject.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initInjections</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = resolveInject(vm.$options.inject, vm)</span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    toggleObserving(<span class="literal">false</span>)</span><br><span class="line">    <span class="built_in">Object</span>.keys(result).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">      <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">        defineReactive(vm, key, result[key], () =&gt; &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">`Avoid mutating an injected value directly since the changes will be `</span> +</span><br><span class="line">            <span class="string">`overwritten whenever the provided component re-renders. `</span> +</span><br><span class="line">            <span class="string">`injection being mutated: "<span class="subst">$&#123;key&#125;</span>"`</span>,</span><br><span class="line">            vm</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        defineReactive(vm, key, result[key])</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    toggleObserving(<span class="literal">true</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolveInject</span> (<span class="params">inject: any, vm: Component</span>): ?<span class="title">Object</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (inject) &#123;</span><br><span class="line">    <span class="comment">// inject is :any because flow is not smart enough to figure out cached</span></span><br><span class="line">    <span class="keyword">const</span> result = <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">const</span> keys = hasSymbol</span><br><span class="line">      ? <span class="built_in">Reflect</span>.ownKeys(inject)</span><br><span class="line">      : <span class="built_in">Object</span>.keys(inject)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> key = keys[i]</span><br><span class="line">      <span class="comment">// #6574 in case the inject object is observed...</span></span><br><span class="line">      <span class="keyword">if</span> (key === <span class="string">'__ob__'</span>) <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">const</span> provideKey = inject[key].from</span><br><span class="line">      <span class="keyword">let</span> source = vm</span><br><span class="line">      <span class="keyword">while</span> (source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (source._provided &amp;&amp; hasOwn(source._provided, provideKey)) &#123;</span><br><span class="line">          result[key] = source._provided[provideKey]</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        source = source.$parent</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">'default'</span> <span class="keyword">in</span> inject[key]) &#123;</span><br><span class="line">          <span class="keyword">const</span> provideDefault = inject[key].default</span><br><span class="line">          result[key] = <span class="keyword">typeof</span> provideDefault === <span class="string">'function'</span></span><br><span class="line">            ? provideDefault.call(vm)</span><br><span class="line">            : provideDefault</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">          warn(<span class="string">`Injection "<span class="subst">$&#123;key&#125;</span>" not found`</span>, vm)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="initState"><a href="#initState" class="headerlink" title="initState"></a>initState</h3><p>initState åˆå§‹åŒ–äº†ä¼ å…¥çš„é…ç½® propsã€methodsã€dataã€computedã€watch ï¼Œåœ¨æ­¤ä¹‹åå°±ç®—å®ä¾‹åˆ›å»ºå®Œæˆï¼Œå¯ä»¥è°ƒç”¨è¿™äº›å±æ€§</p>
<p>åœ¨åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸ initLifecycle æ—¶ï¼Œç»™ vm å¢åŠ äº† watcher ï¼Œæ­¤æ—¶åˆå§‹åŒ– state æ—¶ï¼Œæ–°å¢ _watchers ï¼Œè¡¨ç¤ºå®ä¾‹ä¸‹çš„è§‚å¯Ÿè€…ç»„</p>
<p>å¦‚æœç”¨æˆ·ä¼ å…¥äº†ç›¸å…³çš„é…ç½®ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹å“åº”çš„é…ç½®åˆå§‹åŒ–ï¼Œåœ¨å¤„ç†æ•°æ® data æ—¶ï¼Œå¦‚æœæœ‰ä¼ å…¥ï¼Œé‚£ä¹ˆå°±æŒ‰åˆå§‹åŒ–èµ°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ç›´æ¥å°† vm._data å“åº”å¼åŒ–ï¼Œä¹Ÿæ˜¯ä½œä¸ºæ ¹èŠ‚ç‚¹çš„æ•°æ®</p>
<p>æœŸé—´ propsã€dataã€computedã€watch å‡åšäº†å“åº”å¼å¤„ç†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initState</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  vm._watchers = []</span><br><span class="line">  <span class="keyword">const</span> opts = vm.$options <span class="comment">// å¤–ç•Œä¼ å…¥å€¼çš„ä¸€äº›åˆå§‹åŒ–</span></span><br><span class="line">  <span class="keyword">if</span> (opts.props) initProps(vm, opts.props)</span><br><span class="line">  <span class="keyword">if</span> (opts.methods) initMethods(vm, opts.methods)</span><br><span class="line">  <span class="keyword">if</span> (opts.data) &#123; <span class="comment">// æœ‰å°±åˆå§‹åŒ–ï¼Œæ²¡æœ‰å…ˆè§‚å¯Ÿï¼Œçœ‹å¤–ç•Œä¼ å…¥ä¸ä¼ å…¥</span></span><br><span class="line">    initData(vm)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    observe(vm._data = &#123;&#125;, <span class="literal">true</span> <span class="comment">/* asRootData */</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (opts.computed) initComputed(vm, opts.computed)</span><br><span class="line">  <span class="keyword">if</span> (opts.watch &amp;&amp; opts.watch !== nativeWatch) &#123;</span><br><span class="line">    initWatch(vm, opts.watch)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="initProps"><a href="#initProps" class="headerlink" title="initProps"></a>initProps</h4><p>åˆå§‹åŒ– props</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initProps</span> (<span class="params">vm: Component, propsOptions: Object</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> propsData = vm.$options.propsData || &#123;&#125;</span><br><span class="line">  <span class="keyword">const</span> props = vm._props = &#123;&#125;</span><br><span class="line">  <span class="comment">// cache prop keys so that future props updates can iterate using Array</span></span><br><span class="line">  <span class="comment">// instead of dynamic object key enumeration.</span></span><br><span class="line">  <span class="keyword">const</span> keys = vm.$options._propKeys = []</span><br><span class="line">  <span class="keyword">const</span> isRoot = !vm.$parent</span><br><span class="line">  <span class="comment">// root instance props should be converted</span></span><br><span class="line">  <span class="keyword">if</span> (!isRoot) &#123;</span><br><span class="line">    toggleObserving(<span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> propsOptions) &#123;</span><br><span class="line">    keys.push(key)</span><br><span class="line">    <span class="keyword">const</span> value = validateProp(key, propsOptions, propsData, vm)</span><br><span class="line">    <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> hyphenatedKey = hyphenate(key)</span><br><span class="line">      <span class="keyword">if</span> (isReservedAttribute(hyphenatedKey) ||</span><br><span class="line">          config.isReservedAttr(hyphenatedKey)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">`"<span class="subst">$&#123;hyphenatedKey&#125;</span>" is a reserved attribute and cannot be used as component prop.`</span>,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      defineReactive(props, key, value, () =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isRoot &amp;&amp; !isUpdatingChildComponent) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">`Avoid mutating a prop directly since the value will be `</span> +</span><br><span class="line">            <span class="string">`overwritten whenever the parent component re-renders. `</span> +</span><br><span class="line">            <span class="string">`Instead, use a data or computed property based on the prop's `</span> +</span><br><span class="line">            <span class="string">`value. Prop being mutated: "<span class="subst">$&#123;key&#125;</span>"`</span>,</span><br><span class="line">            vm</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      defineReactive(props, key, value)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// static props are already proxied on the component's prototype</span></span><br><span class="line">    <span class="comment">// during Vue.extend(). We only need to proxy props defined at</span></span><br><span class="line">    <span class="comment">// instantiation here.</span></span><br><span class="line">    <span class="keyword">if</span> (!(key <span class="keyword">in</span> vm)) &#123;</span><br><span class="line">      proxy(vm, <span class="string">`_props`</span>, key)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  toggleObserving(<span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="initMethods"><a href="#initMethods" class="headerlink" title="initMethods"></a>initMethods</h4><p>åˆå§‹åŒ– methods, å…ˆè·å–å½“å‰å®ä¾‹ç»„ä»¶ä¸‹çš„æ–¹æ³•æ˜¯å¦ä¸ props ä¼ å…¥çš„å˜é‡åŒåï¼Œå†æ£€æµ‹è¯¥æ–¹æ³•æ˜¯å¦ä¸ºå‡½æ•°ï¼Œå†æ£€æµ‹è¯¥å‘½åçš„æ–¹æ³•æ˜¯å¦ä¸ Vue å®ä¾‹å›ºæœ‰çš„æ–¹æ³•åå†²çªï¼›è‹¥æ— é—®é¢˜ï¼Œåˆ™å°†è¯¥æ–¹æ³•ç›´æ¥æŒ‚è½½åœ¨å½“å‰å®ä¾‹ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initMethods</span> (<span class="params">vm: Component, methods: Object</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> props = vm.$options.props</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> methods) &#123;</span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> methods[key] !== <span class="string">'function'</span>) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">`Method "<span class="subst">$&#123;key&#125;</span>" has type "<span class="subst">$&#123;<span class="keyword">typeof</span> methods[key]&#125;</span>" in the component definition. `</span> +</span><br><span class="line">          <span class="string">`Did you reference the function correctly?`</span>,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (props &amp;&amp; hasOwn(props, key)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">`Method "<span class="subst">$&#123;key&#125;</span>" has already been defined as a prop.`</span>,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ((key <span class="keyword">in</span> vm) &amp;&amp; isReserved(key)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">`Method "<span class="subst">$&#123;key&#125;</span>" conflicts with an existing Vue instance method. `</span> +</span><br><span class="line">          <span class="string">`Avoid defining component methods that start with _ or $.`</span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vm[key] = <span class="keyword">typeof</span> methods[key] !== <span class="string">'function'</span> ? noop : bind(methods[key], vm)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="initData"><a href="#initData" class="headerlink" title="initData"></a>initData</h4><p>åˆå§‹åŒ–æ•°æ®ï¼Œè¿™é‡Œåœ¨ä¼šåˆ¤æ–­å½“å‰å®ä¾‹æ˜¯å¦å®šä¹‰äº† data, è‹¥æ— åˆ™åˆå§‹åŒ– _data ä¸ºä¸€ä¸ªç©ºå¯¹è±¡, å¹¶ä½¿å…¶å“åº”å¼ï¼Œæ ‡è®°ä¸ºæ ¹æ•°æ®ï¼›</p>
<p>è‹¥å½“å‰å®ä¾‹å®šä¹‰äº† data, åˆ™èµ° initData æµç¨‹, åˆ¤æ–­ data å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°, è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡, è‹¥ä¸ºå‡½æ•°ï¼Œåˆ™é€šè¿‡ getData è·å–å‡½æ•°çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œdata ä¸€èˆ¬éƒ½å†™æˆå‡½æ•°è¿”å›ä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œæ‰€æœ‰ getData åšçš„å·¥ä½œå³æ˜¯å°† data çš„è¿™ä¸ªå‡½æ•°æŒ‡å‘å½“å‰å®ä¾‹ vm , å†å°†ç»“æœè¿”å›åˆ° <code>vm._data</code> ; è‹¥ data æ˜¯ä¸ªå¯¹è±¡ï¼Œé‚£å°±ç›´æ¥è¿”å› dataï¼ˆè§ä¸‹ä¸€çº§åˆ†æï¼‰</p>
<p>æ¥ç€å†æ£€æŸ¥è¿”å›çš„ data æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸æ˜¯åˆ™æŠ›å‡ºè­¦å‘Šï¼›</p>
<p>è·å–å®šä¹‰çš„ data ä¸­çš„å±æ€§ï¼Œä¸å½“å‰å®ä¾‹çš„ methods çš„å˜é‡åè¿›è¡Œæ¯”è¾ƒï¼Œæœ‰å†²çªå°±è­¦å‘Šï¼›å†ä¸ props è¿›è¡Œæ£€æŸ¥ï¼Œç¡®ä¿æ²¡æœ‰å†²çªå˜é‡ï¼›æœ€åæ£€æµ‹è¯¥ data å±æ€§æ˜¯å¦ä¸º Vue å·²æœ‰çš„å˜é‡åï¼Œå¦‚ä¸æ˜¯åˆ™å¯¹ <code>vm._data</code> ä¸‹æ–°å¢è¯¥å˜é‡çš„ä»£ç†ï¼Œè®¾ç½® <code>_data</code> å±æ€§ä¸‹è·å–å„æ•°æ®çš„ get å’Œ set è§„åˆ™</p>
<p>æ³¨æ„ä¸Šæ–¹æ˜¯å¯¹ data å†…çš„å„ä¸ªå±æ€§è¯»å†™åšäº†è®¾å®šï¼Œåœ¨å¤„ç†å®Œè¿™äº›åï¼Œè°ƒç”¨ observe å°† <code>_data</code> åšå“åº”å¼ï¼ŒåŒæ—¶è®¾å®šä¸ºæ ¹æ•°æ®ï¼Œobserve èµ°çš„å³æ˜¯å“åº”å¼æµç¨‹ã€‚ï¼ˆè§ä¸‹ä¸€çº§åˆ†æï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initData</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> data = vm.$options.data</span><br><span class="line">  data = vm._data = <span class="keyword">typeof</span> data === <span class="string">'function'</span> <span class="comment">// å®šä¹‰ data å¿…é¡»ä¸ºä¸€ä¸ªå‡½æ•°</span></span><br><span class="line">    ? getData(data, vm)</span><br><span class="line">    : data || &#123;&#125;</span><br><span class="line">  <span class="keyword">if</span> (!isPlainObject(data)) &#123;</span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; warn(</span><br><span class="line">      <span class="string">'data functions should return an object:\n'</span> +</span><br><span class="line">      <span class="string">'https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function'</span>,</span><br><span class="line">      vm</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// proxy data on instance</span></span><br><span class="line">  <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(data)</span><br><span class="line">  <span class="keyword">const</span> props = vm.$options.props</span><br><span class="line">  <span class="keyword">const</span> methods = vm.$options.methods</span><br><span class="line">  <span class="keyword">let</span> i = keys.length</span><br><span class="line">  <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">    <span class="keyword">const</span> key = keys[i]</span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (methods &amp;&amp; hasOwn(methods, key)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">`Method "<span class="subst">$&#123;key&#125;</span>" has already been defined as a data property.`</span>,</span><br><span class="line">          vm</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (props &amp;&amp; hasOwn(props, key)) &#123;</span><br><span class="line">      process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; warn(</span><br><span class="line">        <span class="string">`The data property "<span class="subst">$&#123;key&#125;</span>" is already declared as a prop. `</span> +</span><br><span class="line">        <span class="string">`Use prop default value instead.`</span>,</span><br><span class="line">        vm</span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isReserved(key)) &#123;</span><br><span class="line">      proxy(vm, <span class="string">`_data`</span>, key) <span class="comment">// åœ¨ Vue ä¸‹æ–°å¢ _data ä¿å­˜æ•°æ®ï¼Œå¹¶å¯¹è¯¥å±æ€§åšå“åº”å¼å¤„ç†</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// observe data</span></span><br><span class="line">  observe(data, <span class="literal">true</span> <span class="comment">/* asRootData */</span>) <span class="comment">// å¯¹æ•°æ®æœ¬èº«åšå“åº”å¼å¤„ç†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="getData"><a href="#getData" class="headerlink" title="getData"></a>getData</h5><p>å¯ä»¥çœ‹åˆ° data æœ¬èº«è¢«å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ ¹æ®æœ‰æ— å®ä¾‹ vm åˆè¿”å› mergeDataOrFn å‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œè€Œ mergeDataOrFn è¿›ä¸€æ­¥æ ¹æ®æœ‰æ— å®ä¾‹ï¼Œæœ‰æ— çˆ¶å­å€¼è¿”å›ä¸åŒçš„ç»“æœï¼Œåœ¨æ­¤æ˜¯è¿”å› mergedInstanceDataFn å‡½æ•°ï¼Œæ‰€ä»¥ data å‡½æ•°æœ¬è´¨ä¸Šå°±æ˜¯ mergedInstanceDataFn å‡½æ•°ï¼›å†å°†å®ä¾‹æ•°æ®ä¸é»˜è®¤æ•°æ®åˆå¹¶åè¿”å›ï¼Œé»˜è®¤æ•°æ®æ˜¯ parentVal ä¼ å…¥çš„å€¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/util/options.js</span></span><br><span class="line"></span><br><span class="line">strats.data = <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  parentVal: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  childVal: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  vm?: Component</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): ?<span class="title">Function</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!vm) &#123;</span><br><span class="line">    <span class="keyword">if</span> (childVal &amp;&amp; <span class="keyword">typeof</span> childVal !== <span class="string">'function'</span>) &#123;</span><br><span class="line">      process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; warn(</span><br><span class="line">        <span class="string">'The "data" option should be a function '</span> +</span><br><span class="line">        <span class="string">'that returns a per-instance value in component '</span> +</span><br><span class="line">        <span class="string">'definitions.'</span>,</span><br><span class="line">        vm</span><br><span class="line">      )</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> parentVal</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mergeDataOrFn(parentVal, childVal)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> mergeDataOrFn(parentVal, childVal, vm)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mergeDataOrFn</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">mergeDataOrFn</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  parentVal: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  childVal: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  vm?: Component</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): ?<span class="title">Function</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!vm) &#123;</span><br><span class="line">    <span class="comment">// in a Vue.extend merge, both should be functions</span></span><br><span class="line">    <span class="keyword">if</span> (!childVal) &#123;</span><br><span class="line">      <span class="keyword">return</span> parentVal</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!parentVal) &#123;</span><br><span class="line">      <span class="keyword">return</span> childVal</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// when parentVal &amp; childVal are both present,</span></span><br><span class="line">    <span class="comment">// we need to return a function that returns the</span></span><br><span class="line">    <span class="comment">// merged result of both functions... no need to</span></span><br><span class="line">    <span class="comment">// check if parentVal is a function here because</span></span><br><span class="line">    <span class="comment">// it has to be a function to pass previous merges.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">mergedDataFn</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> mergeData(</span><br><span class="line">        <span class="keyword">typeof</span> childVal === <span class="string">'function'</span> ? childVal.call(<span class="keyword">this</span>, <span class="keyword">this</span>) : childVal,</span><br><span class="line">        <span class="keyword">typeof</span> parentVal === <span class="string">'function'</span> ? parentVal.call(<span class="keyword">this</span>, <span class="keyword">this</span>) : parentVal</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">mergedInstanceDataFn</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// instance merge</span></span><br><span class="line">      <span class="keyword">const</span> instanceData = <span class="keyword">typeof</span> childVal === <span class="string">'function'</span> <span class="comment">// è·å–å®ä¾‹çš„æ•°æ®</span></span><br><span class="line">        ? childVal.call(vm, vm)</span><br><span class="line">        : childVal</span><br><span class="line">      <span class="keyword">const</span> defaultData = <span class="keyword">typeof</span> parentVal === <span class="string">'function'</span></span><br><span class="line">        ? parentVal.call(vm, vm)</span><br><span class="line">        : parentVal</span><br><span class="line">      <span class="keyword">if</span> (instanceData) &#123;</span><br><span class="line">        <span class="keyword">return</span> mergeData(instanceData, defaultData)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> defaultData</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="observe"><a href="#observe" class="headerlink" title="observe"></a>observe</h5><p>è¡¥å……ä¸‹ä¸Šè¾¹çš„ observe æ–¹æ³•ï¼Œè¿™é‡Œæ˜¯å¯¹å®ä¾‹ä¼ å…¥çš„ data(ä¹Ÿå°±æ˜¯<code>vm._data</code>) åšå“åº”å¼ï¼Œé¦–å…ˆåˆ¤æ–­ <code>_data</code> ä¸Šæ˜¯å¦å­˜åœ¨ <code>__ob__</code> æ ‡è¯†ï¼Œæœ‰å°±è¯´æ˜å·²ç»å“åº”å¼å¤„ç†è¿‡äº†ï¼›</p>
<p>æ²¡æœ‰çš„è¯å°±æ¥ç€åˆ¤æ–­æ˜¯å¦æ»¡è¶³åˆ›å»º Observer çš„æ¡ä»¶ï¼Œå¦‚ data éœ€è¦æ˜¯å¯¹è±¡ã€æ•°ç»„ï¼Œæ˜¯å¦æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ˜¯å¦åº”è¯¥å“åº”å¼ï¼Œè¯¥æ•°æ®ä¸æ˜¯ vue ç­‰ï¼Œæ»¡è¶³ååˆ›å»ºä¸€ä¸ªæ–°çš„ Observer å®ä¾‹ï¼›</p>
<p>æ¯ä¸ª Observer ä¹Ÿä¼šå¯¹åº”ä¸€ä¸ªä¾èµ–æ”¶é›†å™¨ depï¼›æ¥ç€ç»™ data å¯¹è±¡æ·»åŠ  <code>__ob__</code> å±æ€§ï¼Œå¹¶å°†å½“å‰çš„ Observer å®ä¾‹èµ‹å€¼ç»™å®ƒï¼›</p>
<p>æ¥ç€åˆ¤æ–­å½“å‰å“åº”å¼çš„å¯¹è±¡ data æ˜¯æ•°ç»„è¿˜æ˜¯å¯¹è±¡ï¼Œé‡‡ç”¨ä¸åŒçš„æ–¹æ³•è¿›è¡Œå“åº”å¼å¤„ç†ï¼š</p>
<p>å¦‚æ˜¯æ•°ç»„ï¼Œå†åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒåŸå‹ <code>__proto__</code>ï¼Œé‡æ–°å®šä¹‰ä¸‹æ•°ç»„åŸå‹å¢åˆ æ’åºç­‰æ–¹æ³•ï¼Œå¦‚æœæ•°ç»„ä¸­å¢åŠ äº†æ•°æ®ï¼Œéå†æ–°å¢çš„æ•°æ®è¿›è¡Œå“åº”å¼å¤„ç†ï¼ˆå…ƒç´ çº§åˆ«ï¼‰ï¼Œåœ¨æ•°ç»„æ”¹å˜åè°ƒç”¨ notify æ–¹æ³• é€šçŸ¥ Watcher å»æ›´æ–°è§†å›¾ï¼›å¤„ç†å®Œæ•°ç»„åŸå‹ä¸ŠåŸæœ‰é—®é¢˜åï¼Œå†è°ƒç”¨ observeArray æ–¹æ³•å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ç»§ç»­è¿›è¡Œ observe å“åº”å¼å¤„ç†ã€‚</p>
<p>å¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™è°ƒç”¨ walk ç»§ç»­éå†æ¯ä¸ªå±æ€§ç”¨ defineReactive è¿›è¡Œå“åº”å¼å¤„ç†, ç»§ç»­å¯¹æ¯ä¸ªå±æ€§åˆ›å»ºè‡ªå·±çš„ä¾èµ–æ”¶é›†å™¨ depï¼Œå†é€’å½’è°ƒç”¨ observe çœ‹æ¯ä¸ªå±æ€§ä¸‹æ˜¯å¦è¿˜æœ‰å­å±æ€§æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œéƒ½ç»™è¿›è¡Œå“åº”å¼å¤„ç†ï¼Œæœ€åå¯¹è±¡ç”¨ defineProperty æ¥å®ç°å…·ä½“çš„å“åº”å¼æ›´æ–°ï¼Œåˆ©ç”¨ defineProperty ç»™å½“å‰å¯¹è±¡çš„æŸä¸ªå±æ€§é™å®šå…¶ get å’Œ setï¼Œä¸€èˆ¬åœ¨æœ‰ è§‚å¯Ÿè€… watcher çš„æƒ…å†µä¸‹ï¼Œè·å– data æŸä¸ªå±æ€§çš„å€¼ä¾¿ä¼šè§¦å‘ä¾èµ–æ”¶é›†ï¼Œå°†å½“å‰çš„ watcher æ”¾å…¥ä¾èµ–æ”¶é›†å™¨ï¼Œè¿”å›å½“å‰å€¼ï¼›å†åœ¨ä¸‹æ¬¡æ”¹åŠ¨è¯¥å€¼çš„æƒ…å†µä¸‹è§¦å‘ notify æ¥é€šçŸ¥å„ä¸ªè§‚å¯Ÿè€…å»ä¿®æ”¹å¯¹åº”çš„å€¼</p>
<p>è§ä¸‹æ–¹å®šä¹‰ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/observer/index.js</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">observe</span> (<span class="params">value: any, asRootData: ?boolean</span>): <span class="title">Observer</span> | <span class="title">void</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!isObject(value) || value <span class="keyword">instanceof</span> VNode) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> ob: Observer | <span class="keyword">void</span></span><br><span class="line">  <span class="keyword">if</span> (hasOwn(value, <span class="string">'__ob__'</span>) &amp;&amp; value.__ob__ <span class="keyword">instanceof</span> Observer) &#123;</span><br><span class="line">    ob = value.__ob__</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">    shouldObserve &amp;&amp;</span><br><span class="line">    !isServerRendering() &amp;&amp;</span><br><span class="line">    (<span class="built_in">Array</span>.isArray(value) || isPlainObject(value)) &amp;&amp;</span><br><span class="line">    <span class="built_in">Object</span>.isExtensible(value) &amp;&amp;</span><br><span class="line">    !value._isVue</span><br><span class="line">  ) &#123;</span><br><span class="line">    ob = <span class="keyword">new</span> Observer(value) <span class="comment">// ç»™æ•°æ®æ–°å»ºå“åº”å¼å¤„ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (asRootData &amp;&amp; ob) &#123;</span><br><span class="line">    ob.vmCount++</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ob</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å“åº”å¼æ—¶å¯¹æ•°æ®ä¸­çš„æ•°ç»„å’Œå¯¹è±¡åˆ†åˆ«åšäº†ä¸åŒçš„å¤„ç†ï¼Œå¯¹è±¡æˆ‘ä»¬è‡ªç„¶æ¸…æ¥šï¼Œé€’å½’å¤„ç†ç›´åˆ°å½“å‰å¯¹è±¡ä¸‹æ²¡æœ‰å­å¯¹è±¡äº†ï¼Œç”¨ <code>Object.defineProperty</code> æ¥å®Œæˆå“åº”å¼çš„é…ç½®</p>
<p>é‚£ä¹ˆå¯¹äºæ•°ç»„çš„æƒ…å†µï¼Œæƒ³è¦æ§åˆ¶åˆ°æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„å˜åŠ¨èƒ½å“åº”å¼ï¼Œæ•°ç»„å¹¶ä¸èƒ½åƒå¯¹è±¡é‚£æ ·æ‹¦æˆªå±æ€§ï¼Œå› æ­¤åªèƒ½åœ¨ä¸€äº›å¢åˆ å‡æ’çš„æ“ä½œä¸­è·å–å˜åŠ¨å…ƒç´ æ¥å¤„ç†å…¶å“åº”å¼ï¼Œæ¥ç€å¯¹å˜åŠ¨çš„å…ƒç´ ç”¨ observeArray å¤„ç†ï¼Œæ¥ç€é€šçŸ¥è§‚å¯Ÿè€…æ›´æ–°</p>
<p>ä¸‹è¾¹æ˜¯å¯¹æ•°ç»„æ–¹æ³•ä¿®æ”¹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/observer/array.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arrayProto = <span class="built_in">Array</span>.prototype</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> arrayMethods = <span class="built_in">Object</span>.create(arrayProto)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> methodsToPatch = [</span><br><span class="line">  <span class="string">'push'</span>,</span><br><span class="line">  <span class="string">'pop'</span>,</span><br><span class="line">  <span class="string">'shift'</span>,</span><br><span class="line">  <span class="string">'unshift'</span>,</span><br><span class="line">  <span class="string">'splice'</span>,</span><br><span class="line">  <span class="string">'sort'</span>,</span><br><span class="line">  <span class="string">'reverse'</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Intercept mutating methods and emit events</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">methodsToPatch.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">method</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// cache original method</span></span><br><span class="line">  <span class="keyword">const</span> original = arrayProto[method]</span><br><span class="line">  def(arrayMethods, method, <span class="function"><span class="keyword">function</span> <span class="title">mutator</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> result = original.apply(<span class="keyword">this</span>, args)</span><br><span class="line">    <span class="keyword">const</span> ob = <span class="keyword">this</span>.__ob__</span><br><span class="line">    <span class="keyword">let</span> inserted</span><br><span class="line">    <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'push'</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'unshift'</span>:</span><br><span class="line">        inserted = args</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'splice'</span>:</span><br><span class="line">        inserted = args.slice(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (inserted) ob.observeArray(inserted)</span><br><span class="line">    <span class="comment">// notify change</span></span><br><span class="line">    ob.dep.notify()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="initComputed"><a href="#initComputed" class="headerlink" title="initComputed"></a>initComputed</h4><p>åˆå§‹åŒ– <code>vm._computedWatchers</code> ï¼Œåˆ¤æ–­ç”¨æˆ·å®šä¹‰çš„è®¡ç®—å±æ€§æ˜¯å¦ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œé‡‡ç”¨ä¸åŒçš„å¤„ç†æ–¹å¼ï¼›å†åˆ¤æ–­æ˜¯ä¸æ˜¯æœåŠ¡ç«¯æ¸²æŸ“æœŸé—´ï¼Œè‹¥æ˜¯åœ¨æ­¤æœŸé—´ computed ä»…ä¸ºä¸€ä¸ª getter ï¼Œä¸æ˜¯çš„è¯å°†ä¼šä¸ºå½“å‰è®¡ç®—å±æ€§åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€… watcher æŒ‚è½½åœ¨ _computedWatchers ä¸‹ã€‚</p>
<p>æ¥ç€ä¼šè¿›å…¥åˆ° defineComputed ï¼Œä¸æ˜¯å¦ ssr ç›¸åæ¥å®šä¹‰ shouldCache ï¼Œ åˆ¤æ–­ç”¨æˆ·å®šä¹‰çš„è®¡ç®—å±æ€§æ˜¯å¦ä¸ºå‡½æ•°ï¼ŒæŒ‰ shouldCache çš„å¸ƒå°”å€¼æ¥ç¡®å®šä¸‹ä¸€æ­¥ï¼Œå½“å‰ä¸º true ï¼Œåˆ™ä»¤ get å°±ä¸º createComputedGetter è¿”å› computedGetter å‡½æ•°ï¼Œé€šè¿‡è§‚å¯Ÿè€…æ¥è·å–è¯¥è®¡ç®—å±æ€§çš„å€¼ï¼›å†æŠŠè¿™ä¸ª set å’Œ get è§„åˆ™ç”¨ defineProperty ç»™é™å®šåˆ°å®ä¾‹ä¸‹å¯¹åº”åå­—çš„å±æ€§</p>
<p>å½“ç„¶æˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­ä¹Ÿå¯ä»¥ä¸è®¾ç½®ä¸ºå•çº¯çš„å‡½æ•°ï¼Œå¯ä»¥æ‹†æˆ set å’Œ get æ¥å†™ï¼Œè¿™æ ·çš„è¯æ­¤å¤„å°†ä¼šèµ°å¦ä¸€ç§å¤„ç†ï¼Œset ä¸ºç”¨æˆ·è‡ªå®šä¹‰çš„ setï¼Œget åˆ™é¦–å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰ï¼Œæ²¡æœ‰åˆ™é»˜è®¤ noopï¼Œæœ‰åˆ™è¿›ä¸€æ­¥åˆ¤æ–­ shouldCache å’Œ userDef.cache æ¥ç¡®å®šä½¿ç”¨ä½•ç§æ–¹æ³•çš„ get</p>
<p>éšåå¯¹ set è¿›è¡Œæ‹¦æˆªï¼Œset æ˜¯å¦æ˜¯ noopï¼Œæç¤ºè®¡ç®—å±æ€§ä¸èƒ½è®¾ç½® setï¼›æ¥ç€å°†é…ç½®å¥½çš„ getã€set ä¼ å…¥ <code>Object.defineProperty</code> å¯¹å…·ä½“çš„è®¡ç®—å±æ€§è¿›è¡Œé™å®š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initComputed</span> (<span class="params">vm: Component, computed: Object</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// $flow-disable-line</span></span><br><span class="line">  <span class="keyword">const</span> watchers = vm._computedWatchers = <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line">  <span class="comment">// computed properties are just getters during SSR</span></span><br><span class="line">  <span class="keyword">const</span> isSSR = isServerRendering()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> computed) &#123;</span><br><span class="line">    <span class="keyword">const</span> userDef = computed[key]</span><br><span class="line">    <span class="keyword">const</span> getter = <span class="keyword">typeof</span> userDef === <span class="string">'function'</span> ? userDef : userDef.get</span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; getter == <span class="literal">null</span>) &#123;</span><br><span class="line">      warn(</span><br><span class="line">        <span class="string">`Getter is missing for computed property "<span class="subst">$&#123;key&#125;</span>".`</span>,</span><br><span class="line">        vm</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isSSR) &#123;</span><br><span class="line">      <span class="comment">// create internal watcher for the computed property.</span></span><br><span class="line">      watchers[key] = <span class="keyword">new</span> Watcher(</span><br><span class="line">        vm,</span><br><span class="line">        getter || noop,</span><br><span class="line">        noop,</span><br><span class="line">        computedWatcherOptions</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// component-defined computed properties are already defined on the</span></span><br><span class="line">    <span class="comment">// component prototype. We only need to define computed properties defined</span></span><br><span class="line">    <span class="comment">// at instantiation here.</span></span><br><span class="line">    <span class="keyword">if</span> (!(key <span class="keyword">in</span> vm)) &#123;</span><br><span class="line">      defineComputed(vm, key, userDef)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (key <span class="keyword">in</span> vm.$data) &#123;</span><br><span class="line">        warn(<span class="string">`The computed property "<span class="subst">$&#123;key&#125;</span>" is already defined in data.`</span>, vm)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vm.$options.props &amp;&amp; key <span class="keyword">in</span> vm.$options.props) &#123;</span><br><span class="line">        warn(<span class="string">`The computed property "<span class="subst">$&#123;key&#125;</span>" is already defined as a prop.`</span>, vm)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// defineComputed</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">defineComputed</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  target: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  key: string,</span></span></span><br><span class="line"><span class="function"><span class="params">  userDef: Object | Function</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> shouldCache = !isServerRendering()</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> userDef === <span class="string">'function'</span>) &#123;</span><br><span class="line">    sharedPropertyDefinition.get = shouldCache</span><br><span class="line">      ? createComputedGetter(key)</span><br><span class="line">      : createGetterInvoker(userDef)</span><br><span class="line">    sharedPropertyDefinition.set = noop</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    sharedPropertyDefinition.get = userDef.get</span><br><span class="line">      ? shouldCache &amp;&amp; userDef.cache !== <span class="literal">false</span></span><br><span class="line">        ? createComputedGetter(key)</span><br><span class="line">        : createGetterInvoker(userDef.get)</span><br><span class="line">      : noop</span><br><span class="line">    sharedPropertyDefinition.set = userDef.set || noop</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp;</span><br><span class="line">      sharedPropertyDefinition.set === noop) &#123;</span><br><span class="line">    sharedPropertyDefinition.set = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      warn(</span><br><span class="line">        <span class="string">`Computed property "<span class="subst">$&#123;key&#125;</span>" was assigned to but it has no setter.`</span>,</span><br><span class="line">        <span class="keyword">this</span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(target, key, sharedPropertyDefinition)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// createComputedGetter</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createComputedGetter</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">computedGetter</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> watcher = <span class="keyword">this</span>._computedWatchers &amp;&amp; <span class="keyword">this</span>._computedWatchers[key]</span><br><span class="line">    <span class="keyword">if</span> (watcher) &#123;</span><br><span class="line">      <span class="keyword">if</span> (watcher.dirty) &#123;</span><br><span class="line">        watcher.evaluate()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">        watcher.depend()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> watcher.value</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="initWatch"><a href="#initWatch" class="headerlink" title="initWatch"></a>initWatch</h4><p>åˆå§‹åŒ–ç”¨æˆ·ä¹¦å†™çš„ watch , åˆ¤æ–­æˆ‘ä»¬å†™çš„ watch ä¸‹çš„å˜é‡æ˜¯ä¸æ˜¯æ•°ç»„ï¼Œå¦‚ä¸æ˜¯åˆ™ç›´æ¥åˆ›å»º watcherï¼Œå¦‚æ˜¯åˆ™éå†æ•°ç»„ç»™æ¯ä¸ªå…ƒç´ éƒ½æ‰§è¡Œ createWatcher</p>
<p>æ¥ç€åˆ¤æ–­æ˜¯ä¸æ˜¯å¯¹è±¡ï¼Œæ˜¯ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè¿›è¡Œç›¸åº”å¤„ç†ï¼›æœ€åè¿”å› $watch æ–¹æ³•å¤„ç†è¯¥è§‚å¯Ÿçš„å˜é‡å’Œæ“ä½œçš„ç»“æœ</p>
<p>åœ¨åˆå§‹åŒ– Vue çš„ stateMixin é˜¶æ®µï¼Œç»™ Vue çš„åŸå‹ä¸ŠæŒ‚è½½äº† $watch æ–¹æ³•</p>
<p>$watch å…ˆåˆ¤æ–­ç”¨æˆ·å®šä¹‰çš„æ“ä½œæ˜¯å¦æ˜¯ä¸ªå¯¹è±¡ï¼Œå¦‚æ˜¯åˆ™æ‰§è¡Œ createWatcher ï¼Œæ¥ç€åˆ›å»ºè§‚å¯Ÿè€… watcherï¼Œè¢«è§‚å¯Ÿçš„å¯¹è±¡å°±æ˜¯ watch é‡Œå†™çš„å˜é‡ï¼Œå›è°ƒå°±æ˜¯ç”¨æˆ·çš„æ“ä½œï¼Œå½“è¯¥å˜é‡å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä¼šé€šçŸ¥å„è§‚å¯Ÿè€…æ›´æ–°å˜é‡ï¼Œæ‰§è¡Œå›è°ƒã€‚</p>
<p>åˆ›å»ºè¿™ä¸ªè§‚å¯Ÿè€…æ—¶ï¼Œä¼šè¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œæ­¤æ—¶çš„ä¾èµ–æ”¶é›†ç›®æ ‡ <code>Dep.target</code> å°±æ˜¯å½“å‰è¿™ä¸ªè§‚å¯Ÿè€…ï¼›è€Œä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è®¡ç®—å±æ€§ sumï¼Œè®¡ç®—å±æ€§åœ¨ä¸Šä¸€æ­¥å·²ç»è¿›è¡Œå“åº”å¼å¤„ç†ï¼Œé‚£ä¹ˆæ­¤æ—¶è¯»å– sum ä¹Ÿä¼šè¿›å…¥ç›¸åº”è¢«æ‹¦æˆªçš„æ­¥éª¤ï¼Œåœ¨ get è®¡ç®—å±æ€§æ—¶ï¼Œåˆä¼šå°†è®¡ç®—å±æ€§å¯¹åº”çš„è§‚å¯Ÿè€…ä½œä¸ºå…¨å±€çš„ <code>Dep.target</code> , ç„¶åè§‚å¯Ÿè€…ä¼šå°†å½“å‰çš„ä¾èµ– dep æ”¶é›†èµ·æ¥ï¼ŒåŒæ—¶å°†å½“å‰è§‚å¯Ÿè€…æ·»åŠ åˆ° <code>dep.subs</code>ï¼Œå¹¶è¿”å›è®¡ç®—å±æ€§ sum çš„å€¼ï¼Œæ­¤æ—¶å¼¹å‡ºå½“å‰çš„ <code>Dep.target</code>ï¼Œæ¸…é™¤æ‰ä¾èµ–æ”¶é›†ï¼›</p>
<p>é‚£ä¹ˆæ­¤æ—¶ <code>Dep.target</code> åˆå›åˆ° watch å¯¹åº”çš„è§‚å¯Ÿè€…ï¼Œæ¥ç€åˆå°†å½“å‰çš„ä¾èµ–ï¼ˆè¯¥ä¾èµ–ä¸ä¸Šä¸ªä¾èµ–ä¸€æ ·ï¼Œå‡æ˜¯ sum è¿™ä¸ªè¢«è§‚å¯Ÿè€…ï¼‰è¿›è¡Œæ”¶é›†ï¼ŒåŒæ—¶å°†è§‚å¯Ÿè€…æ·»åŠ åˆ° subsï¼Œé‚£ä¹ˆæ­¤æ—¶è¯¥ä¾èµ–ä¸‹ subs å°±æœ‰äº†ä¸¤ä¸ªè§‚å¯Ÿè€…ï¼Œ<br>å¼¹å‡ºå½“å‰çš„ <code>Dep.target</code>ï¼Œæ¸…é™¤æ‰å½“å‰çš„ depsï¼Œå¹¶è¿”å›è·å¾—çš„ sum å€¼ã€‚</p>
<p>å¦‚æœ watch çš„é…ç½®æœ‰ <code>options.immediate</code>ï¼Œé‚£ä¹ˆç«‹åˆ»è§¦å‘å½“å‰çš„å›è°ƒã€‚æœ€ç»ˆ $watch æ–¹æ³•è¿”å› unwatchFn å‡½æ•°å¾…æ‰§è¡Œï¼Œæ‰§è¡Œçš„è¿‡ç¨‹å³æ˜¯å°†åˆšåˆ›å»ºçš„ watcher ç»™ teardown æ‰ï¼Œä¹Ÿå°±æ˜¯ä»å®ä¾‹ä¸‹çš„ _watchers ä¸­ç§»é™¤æ‰å½“å‰è§‚å¯Ÿè€…ï¼Œå¹¶ä¸”ä»å„ä¾èµ–æ”¶é›†å™¨ dep ç»‘å®šçš„ subs ä¸­ç§»é™¤</p>
<p>æ­¤æ—¶åˆå§‹åŒ– watch å°±å®Œæˆäº†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initWatch</span> (<span class="params">vm: Component, watch: Object</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> watch) &#123;</span><br><span class="line">    <span class="keyword">const</span> handler = watch[key]</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(handler)) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; handler.length; i++) &#123;</span><br><span class="line">        createWatcher(vm, key, handler[i])</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      createWatcher(vm, key, handler)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// createWatcher</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWatcher</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  vm: Component,</span></span></span><br><span class="line"><span class="function"><span class="params">  expOrFn: string | Function,</span></span></span><br><span class="line"><span class="function"><span class="params">  handler: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  options?: Object</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isPlainObject(handler)) &#123;</span><br><span class="line">    options = handler</span><br><span class="line">    handler = handler.handler</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> handler === <span class="string">'string'</span>) &#123;</span><br><span class="line">    handler = vm[handler]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> vm.$watch(expOrFn, handler, options)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/state.js</span></span><br><span class="line"></span><br><span class="line">Vue.prototype.$watch = <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  expOrFn: string | Function,</span></span></span><br><span class="line"><span class="function"><span class="params">  cb: any,</span></span></span><br><span class="line"><span class="function"><span class="params">  options?: Object</span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">Function</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> vm: Component = <span class="keyword">this</span></span><br><span class="line">  <span class="keyword">if</span> (isPlainObject(cb)) &#123;</span><br><span class="line">    <span class="keyword">return</span> createWatcher(vm, expOrFn, cb, options)</span><br><span class="line">  &#125;</span><br><span class="line">  options = options || &#123;&#125;</span><br><span class="line">  options.user = <span class="literal">true</span></span><br><span class="line">  <span class="keyword">const</span> watcher = <span class="keyword">new</span> Watcher(vm, expOrFn, cb, options)</span><br><span class="line">  <span class="keyword">if</span> (options.immediate) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      cb.call(vm, watcher.value)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      handleError(error, vm, <span class="string">`callback for immediate watcher "<span class="subst">$&#123;watcher.expression&#125;</span>"`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">unwatchFn</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    watcher.teardown()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="initProvide"><a href="#initProvide" class="headerlink" title="initProvide"></a>initProvide</h3><p>provide åˆå§‹åŒ–åªæ˜¯å°†å½“å‰å®ä¾‹ä¸Š $options çš„ provide ä¿å­˜åœ¨ <code>vm._provided</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// core/instance/provide.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initProvide</span> (<span class="params">vm: Component</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> provide = vm.$options.provide</span><br><span class="line">  <span class="keyword">if</span> (provide) &#123;</span><br><span class="line">    vm._provided = <span class="keyword">typeof</span> provide === <span class="string">'function'</span></span><br><span class="line">      ? provide.call(vm)</span><br><span class="line">      : provide</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="created"><a href="#created" class="headerlink" title="created"></a><strong>created</strong></h3><p>åç»­è§ compile ç¯‡</p>

      
    </div>
    <br>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/blog/categories/notes/">notes</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Frontend/">Frontend</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Vue/">Vue</a></li></ul>

      
	<span class="ico-date"></span>
	<a href="/blog/2021/07/26/2-frontend-vue-source2-init/" class="article-date">
	  <time datetime="2021-07-25T16:00:00.000Z" itemprop="datePublished">ä¸ƒæœˆ 26, 2021</time>
	</a>

      <!-- æ·»åŠ å­—æ•°ç»Ÿè®¡ -->
      
        <span class="ico-fontcount"></span><span class="post-count">7.1kå­—</span>
      
    </footer>
    <!-- æ–‡ç« æ·»åŠ è¯„è®º -->
    
      
    <script defer src="//unpkg.com/leancloud-storage@4/dist/av-min.js"></script>
    <script defer src='//unpkg.com/valine@latest/dist/Valine.min.js'></script>
    <div id="vcomments"></div>
    <script>

        var notify = 'false' == true ? true : false;
        var verify = 'false' == true ? true : false;
		// è®¾ç½®è½®è¯¢
		const timer = setInterval(() => {
			if (window.Valine && typeof window.Valine === 'function') {
				clearInterval(timer);
				new Valine({
					el: '#vcomments',
					notify: notify,
					verify: verify,
					app_id: 'AJj6aG4cDMBqBIISAr1U53Az-gzGzoHsz',
					app_key: 'bIYBhlht4PSXI4pCWuH7Gnuo',
					placeholder: 'say something bro ~',
					avatar: 'monsterid',
					avatarCDN:'https://cravatar.cn/avatar/'
				});
			}
		}, 1000);
    </script>



    
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2021/08/02/2-frontend-vue-source3-compile/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
      <div class="article-nav-title">
        
          ğŸ”¥ å‰ç«¯ | Vue2 åˆå§‹åŒ–æµç¨‹ - compile
        
      </div>
    </a>
  
  
    <a href="/blog/2021/07/22/2-frontend-vue-reactivity/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
      <div class="article-nav-title">ğŸ”¥ å‰ç«¯ | Vue2 å“åº”å¼æµç¨‹å­¦ä¹ ä¸å®ç°</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#å‡†å¤‡"><span class="nav-number">1.</span> <span class="nav-text">å‡†å¤‡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#package-json"><span class="nav-number">1.1.</span> <span class="nav-text">package.json</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#launch-json"><span class="nav-number">1.2.</span> <span class="nav-text">launch.json</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#æ–­ç‚¹è°ƒè¯•æ•´ä¸ªæµç¨‹"><span class="nav-number">2.</span> <span class="nav-text">æ–­ç‚¹è°ƒè¯•æ•´ä¸ªæµç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#init"><span class="nav-number">2.1.</span> <span class="nav-text">init</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mergeOptions"><span class="nav-number">2.1.1.</span> <span class="nav-text">mergeOptions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initProxy"><span class="nav-number">2.1.2.</span> <span class="nav-text">initProxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initLifecycle"><span class="nav-number">2.1.3.</span> <span class="nav-text">initLifecycle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initEvents"><span class="nav-number">2.1.4.</span> <span class="nav-text">initEvents</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initRender"><span class="nav-number">2.1.5.</span> <span class="nav-text">initRender</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#beforeCreate"><span class="nav-number">2.1.6.</span> <span class="nav-text">__beforeCreate__</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initInjections"><span class="nav-number">2.1.7.</span> <span class="nav-text">initInjections</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initState"><span class="nav-number">2.1.8.</span> <span class="nav-text">initState</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#initProps"><span class="nav-number">2.1.8.1.</span> <span class="nav-text">initProps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#initMethods"><span class="nav-number">2.1.8.2.</span> <span class="nav-text">initMethods</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#initData"><span class="nav-number">2.1.8.3.</span> <span class="nav-text">initData</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#getData"><span class="nav-number">2.1.8.3.1.</span> <span class="nav-text">getData</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#observe"><span class="nav-number">2.1.8.3.2.</span> <span class="nav-text">observe</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#initComputed"><span class="nav-number">2.1.8.4.</span> <span class="nav-text">initComputed</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#initWatch"><span class="nav-number">2.1.8.5.</span> <span class="nav-text">initWatch</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#initProvide"><span class="nav-number">2.1.9.</span> <span class="nav-text">initProvide</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#created"><span class="nav-number">2.1.10.</span> <span class="nav-text">created</span></a></li></ol></li></ol></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">HOME</a>
  
    <a href="/blog/archives" class="mobile-nav-link">ARCHIVES</a>
  
    <a href="/blog/categories" class="mobile-nav-link">CATEGORIES</a>
  
    <a href="/blog/about" class="mobile-nav-link">ABOUT</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2025 Arginsen&#39;s Blog All Rights Reserved.
      </div>
      <div class="site-credit">
        ID  <a href="https://lixupeng.cn" target="_blank">Arginsen</a>
      </div>
      <br>
      <div class="busuanzi-analytics">
        
        <span id="busuanzi_container_site_pv">
          æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
        </span>
        <span class="post-meta-divider">|</span>
        <!-- <span id="busuanzi_container_site_uv">
          æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº
        </span> -->
        <span class="post-count">å…¨ç«™å…± 343.3k å­—</span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        
      </div>
  </div> 
</footer>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>
<script src="/blog/js/bootstrap.js"></script>
<script src="/blog/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>


<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?bb74e3da22205cadfa4f6e0a31a76ac4";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>
    


  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/blog/js/totop.js" async=""></script>
</body>
</html>
